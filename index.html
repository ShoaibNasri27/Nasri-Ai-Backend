<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nasri AI App Builder Pro</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<style>
body {margin:0; font-family: Arial,sans-serif; background:#f8fafc; color:black; transition: background 0.3s, color 0.3s;}
.dark-mode body { background:#0f172a; color:white; }
.dark-mode header { background:#1e293b; color:white; }
.dark-mode input, .dark-mode textarea { background:#1e293b; color:white; }
.dark-mode iframe { background:#1e293b; color:white; }
.dark-mode button { opacity:0.9; }

header { background:#e2e8f0; padding:15px; text-align:center; font-weight:bold; font-size:18px; transition: background 0.3s, color 0.3s; }
.container { padding:15px; }
input, textarea { width:100%; padding:10px; margin-top:10px; border-radius:8px; border:none; box-sizing:border-box; }
textarea { height:180px; }
button { width:100%; padding:12px; margin-top:10px; border:none; border-radius:8px; font-weight:bold; cursor:pointer; box-sizing:border-box; }
.green { background:#22c55e; color:white; }
.blue { background:#3b82f6; color:white; }
.orange { background:#f59e0b; color:white; }
.red { background:#ef4444; color:white; }
.purple { background:#8b5cf6; color:white; }
iframe { width:100%; height:250px; margin-top:15px; border-radius:10px; background:white; }
.footer { text-align:center; padding:10px; opacity:0.6; }

/* ===== Splash ===== */
#splash {
  position: fixed; top:0; left:0; width:100%; height:100%;
  display:flex; flex-direction:column; justify-content:center; align-items:center;
  background: linear-gradient(135deg,#0f172a,#3b82f6,#22c55e);
  background-size: 400% 400%;
  color:white; font-size:36px; font-weight:bold; text-align:center; z-index:9999;
  animation: gradientMove 8s ease infinite;
}
@keyframes gradientMove{
  0%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
  100%{background-position:0% 50%;}
}
#splash h1 { 
  font-size:42px; 
  text-shadow: 2px 2px 15px rgba(0,0,0,0.5), 0 0 20px rgba(255,255,255,0.3); 
  animation: popIn 1s ease-in-out infinite alternate;
}
@keyframes popIn { 0%{transform:scale(0.95)} 100%{transform:scale(1.05)} }
#splash .dots span{
  display:inline-block; font-size:36px; animation:bounce 1s infinite;
}
#splash .dots span:nth-child(1){animation-delay:0s;}
#splash .dots span:nth-child(2){animation-delay:0.2s;}
#splash .dots span:nth-child(3){animation-delay:0.4s;}
@keyframes bounce {0%,100%{transform:translateY(0);}50%{transform:translateY(-10px);}}

#chatBoxContainer {width:100%; margin-top:10px;}
#chatBox{width:100%;height:300px;border:1px solid #ccc;border-radius:10px;overflow-y:auto;padding:10px;background:white;}
.chat-message{margin:5px 0;}
.user{color:blue;font-weight:bold;}
.bot{color:green;font-weight:bold;}
#userInputContainer{display:flex; margin-top:5px;}
#userInput{flex:1; padding:10px; border-radius:8px; border:1px solid #ccc;}
#sendBtn{width:50px; margin-left:5px; border-radius:8px; background:#3b82f6; color:white; font-weight:bold; cursor:pointer;}
</style>
</head>

<body>

<!-- Splash -->
<div id="splash">
  <h1>Welcome to<br>Nasri AI</h1>
  <div class="dots"><span>.</span><span>.</span><span>.</span></div>
</div>

<header>Nasri AI App Builder Pro</header>

<div class="container">

<!-- Dark/Light Toggle -->
<button class="purple" id="toggleMode" onclick="toggleMode()">Dark</button>

<!-- Nasri AI Chat Section -->
<h3>Nasri AI Chat</h3>
<div id="chatBoxContainer">
    <div id="chatBox"></div>
    <div id="userInputContainer">
        <textarea id="userInput" placeholder="Type your message..."></textarea>
        <button id="sendBtn" onclick="sendMessage()">➡️</button>
    </div>
</div>

<hr style="margin:25px 0;">

<!-- Project Options -->
<button class="green" onclick="newProject()">New Project</button>
<input type="text" id="filename" placeholder="File Name (index.html)">
<textarea id="code" placeholder="Paste your HTML code here..."></textarea>
<button class="blue" onclick="previewCode()">Preview</button>
<button class="green" onclick="saveProject()">Save Project</button>
<button class="orange" onclick="generateZip()">Download ZIP</button>
<button class="red" onclick="aiEnhance()">AI Enhance</button>
<iframe id="preview"></iframe>

</div>

<div class="footer">Created by Nasri Digital Lab © 2026</div>

<script>
let projects = {};

// ===== Splash Timeout =====
window.addEventListener("load", ()=>{
  setTimeout(()=>{
    document.getElementById("splash").style.opacity="0";
    setTimeout(()=>{document.getElementById("splash").style.display="none";},500);
  },3000);
});

// ===== Dark/Light Mode =====
function toggleMode(){
  let body=document.body; let btn=document.getElementById("toggleMode");
  if(body.classList.contains("dark-mode")){ body.classList.remove("dark-mode"); btn.innerText="Dark"; }
  else{ body.classList.add("dark-mode"); btn.innerText="Light"; }
}

// ===== Project Functions =====
function saveProject(){ let name=document.getElementById("filename").value.trim(); let code=document.getElementById("code").value.trim(); if(name===""||code===""){alert("Enter file name and code");return;} projects[name]=code; alert("Project Saved ✅");}
function newProject(){ document.getElementById("filename").value=""; document.getElementById("code").value=""; }
function previewCode(){ document.getElementById("preview").srcdoc=document.getElementById("code").value; }
function generateZip(){ if(Object.keys(projects).length===0){alert("No projects saved");return;} let zip=new JSZip(); for(let name in projects){ zip.file(name,projects[name]); } zip.generateAsync({type:"blob"}).then(function(content){ saveAs(content,"Nasri_Project.zip"); alert("Download started ✅"); }); }
function aiEnhance(){ let code=document.getElementById("code").value.trim(); if(code===""){ alert("Paste code first"); return;} if(!code.includes("<html")){ code=`<html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Enhanced Page</title></head><body>${code}</body></html>`; } if(!code.includes("viewport")){ code=code.replace("<head>", `<head>\n<meta name="viewport" content="width=device-width, initial-scale=1.0">`); } if(code.includes("<body") && !code.includes("font-family")){ code=code.replace("<body>", `<body style="margin:0;font-family:Arial,sans-serif;">`); } document.getElementById("code").value=code; previewCode(); alert("AI Enhancement Applied ✅"); }

// ===== Nasri AI Chat Functions =====
const chatBox = document.getElementById("chatBox");
async function sendMessage() {
    const userInput = document.getElementById("userInput");
    const message = userInput.value.trim();
    if(!message) return;

    const userDiv = document.createElement("div");
    userDiv.classList.add("chat-message","user");
    userDiv.textContent = "You: " + message;
    chatBox.appendChild(userDiv);

    userInput.value = "";
    chatBox.scrollTop = chatBox.scrollHeight;

    try {
        const response = await fetch("https://YOUR_RENDER_PUBLIC_URL/sendMessage", {
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({message})
        });
        const data = await response.json();
        const botDiv = document.createElement("div");
        botDiv.classList.add("chat-message","bot");
        botDiv.textContent = "Nasri AI: " + (data.reply || "No reply");
        chatBox.appendChild(botDiv);
        chatBox.scrollTop = chatBox.scrollHeight;
    } catch (err) {
        const errorDiv = document.createElement("div");
        errorDiv.classList.add("chat-message","bot");
        errorDiv.textContent = "Nasri AI: Error connecting to server";
        chatBox.appendChild(errorDiv);
    }
}
</script>

</body>
</html>
